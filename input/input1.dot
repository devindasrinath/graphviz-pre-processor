digraph {
    node [shape=rectangle, width=2, height=2];
    edge [style=solid];
    graph [rankdir=LR, splines=ortho, nodesep=3, ranksep=4.0];

    "router 1" -> "retry_detector" [label="source_1->message_in"];
    "router 1" -> "task exec 1" [label="source_2->"];
    "router 1" -> "metric_publish_event_broadcaster" [label="source_4->in"];
    "router 1" -> "No ops 1" [label="remaining_source->"];
    "router 1" -> "backend_suspension_cct_controller/1" [label="source_5->message_in"];
    "retry_detector" -> "preflight_response/1" [label="first_try_out->message_in"];
    "retry_detector" -> "priority_based_pool_selector/1" [label="retry_out->message_in"];
    "retry_detector" -> "http_error_dispatcher" [label="exception_out->error_message_in"];
    "preflight_response/1" -> "jwt_validator/1" [label="valid_out->message_in"];
    "preflight_response/1" -> "cors_dispatcher" [label="cors_out->cors_message_in"];
    "preflight_response/1" -> "http_error_dispatcher" [label="error_out->error_message_in"];
    "jwt_validator/1" -> "message aug 1" [label="valid_out->message_in"];
    "jwt_validator/1" -> "http_error_dispatcher" [label="invalid_out->error_message_in"];
    "jwt_validator/1" -> "http_error_dispatcher" [label="expired_out->error_message_in"];
    "jwt_validator/1" -> "http_error_dispatcher" [label="non_jwt_out->error_message_in"];
    "http_error_dispatcher" -> "message_in" [label="error_message_out->"];
    "cors_dispatcher" -> "message_in" [label="cors_message_out->"];
    "message aug 1" -> "request_metrics_stage" [label="message_out->message_in"];
    "request_metrics_stage" -> "scope_validator" [label="message_out->message_in"];
    "scope_validator" -> "subscription_validator" [label="valid_out->message_in"];
    "scope_validator" -> "http_error_dispatcher" [label="invalid_out->error_message_in"];
    "subscription_validator" -> "key_generator" [label="valid_out->in"];
    "key_generator" -> "application_throttler" [label="out->message_in"];
    "application_throttler" -> "subscription_throttler" [label="allowed_out->message_in"];
    "subscription_throttler" -> "advanced_message_throttler" [label="allowed_out->message_in"];
    "advanced_message_throttler" -> "tenant_throttler" [label="allowed_out->message_in"];
    "tenant_throttler" -> "http_request_validator_stage/1" [label="allowed_out->in"];
    "advanced_message_throttler" -> "http_error_dispatcher" [label="throttled_out->error_message_in"];
    "application_throttler" -> "http_error_dispatcher" [label="throttled_out->error_message_in"];
    "subscription_throttler" -> "http_error_dispatcher" [label="throttled_out->error_message_in"];
    "tenant_throttler" -> "http_error_dispatcher" [label="throttled_out->error_message_in"];
    "priority_based_pool_selector/1" -> "http_error_dispatcher" [label="throttled_out->error_message_in"];
    "subscription_validator" -> "http_error_dispatcher" [label="invalid_out->error_message_in"];
    "http_request_validator_stage/1" -> "whitelist_stage_sender_ip/1" [label="valid_requests_out->message_in"];
    "whitelist_stage_sender_ip/1" -> "blacklist_stage_sender_ip/1" [label="out->message_in"];
    "whitelist_stage_sender_ip/1" -> "http_error_dispatcher" [label="exception_out->error_message_in"];
    "whitelist_stage_sender_ip/1" -> "http_error_dispatcher" [label="filtered->error_message_in"];
    "blacklist_stage_sender_ip/1" -> "http_error_dispatcher" [label="filtered->error_message_in"];
    "blacklist_stage_sender_ip/1" -> "http_error_dispatcher" [label="exception_out->error_message_in"];
    "blacklist_stage_sender_ip/1" -> "custom_policy_request" [label="out->message_in"];
    "custom_policy_request" -> "jwt_encode_stage" [label="out->message_in"];
    "jwt_encode_stage" -> "pool_initializer_stage/1" [label="encode_token_out->message_in"];
    "jwt_encode_stage" -> "http_error_dispatcher" [label="error_encode_out->error_message_in"];
    "pool_initializer_stage/1" -> "priority_based_pool_selector/1" [label="message_out->message_in"];
    "priority_based_pool_selector/1" -> "key_generator/2" [label="message_out->in"];
    "priority_based_pool_selector/1" -> "http_error_dispatcher" [label="invalid_out->error_message_in"];
    "key_generator/2" -> "pool_throttler" [label="out->message_in"];
    "pool_throttler" -> "backend_suspension_cct_controller/1" [label="allowed_out->message_in"];
    "pool_throttler" -> "pool_enforcer_retry_stage/1" [label="throttled_out->message_in"];
    "pool_enforcer_retry_stage/1" -> "dropped 1" [label="retry_out->"];
    "backend_retry_configuring_stage/1" -> "dropped 1" [label="retry_out->"];
    "backend_suspension_cct_controller/1" -> "load_balancing_routing_stage/1" [label="message_out->message_in"];
    "backend_suspension_cct_controller/1" -> "http_error_dispatcher" [label="error_out->error_message_in"];
    "load_balancing_routing_stage/1" -> "round_robin_lb_strategy_stage/1" [label="message_out-round_robin->in"];
    "load_balancing_routing_stage/1" -> "simple_failover_stage/1" [label="message_out-failover->message_in"];
    "load_balancing_routing_stage/1" -> "round_robin_lb_strategy_stage/1" [label="message_out-default->in"];
    "load_balancing_routing_stage/1" -> "http_error_dispatcher" [label="invalid_out->error_message_in"];
    "round_robin_lb_strategy_stage/1" -> "backend_retry_configuring_stage/1" [label="invalid_out->message_in"];
    "simple_failover_stage/1" -> "backend_retry_configuring_stage/1" [label="retry_source->message_in"];
    "simple_failover_stage/1" -> "key_generator/3" [label="message_out->in"];
    "round_robin_lb_strategy_stage/1" -> "key_generator/3" [label="out->in"];
    "key_generator/3" -> "backend_throttler" [label="out->message_in"];
    "backend_throttler" -> "path_mapping_stage" [label="allowed_out->message_in"];
    "backend_throttler" -> "backend_retry_configuring_stage/1" [label="throttled_out->message_in"];
    "path_mapping_stage" -> "request_header_handling_stage" [label="message_out->message_in"];
    "request_header_handling_stage" -> "backend_authorization_stage/1" [label="out->message_in"];
    "backend_authorization_stage/1" -> "retry_configuring_stage/1" [label="out->message_in"];
    "retry_configuring_stage/1" -> "throttle_massage_duplicate_stage" [label="out->message_in"];
    "throttle_massage_duplicate_stage" -> "backend_dispatcher_selector_stage" [label="message_out->message_in"];
    "backend_dispatcher_selector_stage" -> "_http_backend_info_provider_stage" [label="http_message_out->message_in"];
    "backend_dispatcher_selector_stage" -> "_https_backend_info_provider_stage" [label="https_message_out->message_in"];
    "_http_backend_info_provider_stage" -> "http_dispatcher/1" [label="message_out->request_in"];
    "_https_backend_info_provider_stage" -> "https_dispatcher/1" [label="message_out->request_in"];
    "throttle_massage_duplicate_stage" -> "message_in" [label="throttle_message_out->"];
    "request_header_handling_stage" -> "http_error_dispatcher" [label="exception_out->error_message_in"];
    "http_dispatcher/1" -> "circuit_breaker_response_transformer_stage" [label="response_out->message_in"];
    "https_dispatcher/1" -> "circuit_breaker_response_transformer_stage" [label="response_out->message_in"];
    "circuit_breaker_response_transformer_stage" -> "backend_response/1" [label="message_out->message_in"];
    "backend_response/1" -> "response_pre_processor/1" [label="out->message_in"];
    "response_pre_processor/1" -> "response_header_handling_stage" [label="out->message_in"];
    "response_header_handling_stage" -> "retry_stage" [label="out->message_in"];
    "retry_stage" -> "response_enricher/1" [label="retry_success->message_in"];
    "retry_stage" -> "http_error_dispatcher" [label="retry_fail->error_message_in"];
    "response_enricher/1" -> "message_in" [label="out->"];
    "response_header_handling_stage" -> "response_enricher/1" [label="out->message_in"];
}

